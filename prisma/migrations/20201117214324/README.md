# Migration `20201117214324`

This migration has been generated by Alejandro D at 11/17/2020, 5:43:24 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_instructorId_fkey"

ALTER TABLE "public"."FollowersOfEvents" DROP CONSTRAINT "FollowersOfEvents_eventId_fkey"

ALTER TABLE "public"."FollowersOfEvents" DROP CONSTRAINT "FollowersOfEvents_followerId_fkey"

ALTER TABLE "public"."Location" DROP CONSTRAINT "Location_eventId_fkey"

ALTER TABLE "public"."_CategoryToEvent" DROP CONSTRAINT "_CategoryToEvent_A_fkey"

ALTER TABLE "public"."_CategoryToEvent" DROP CONSTRAINT "_CategoryToEvent_B_fkey"

ALTER TABLE "public"."Category" DROP CONSTRAINT "Category_pkey",
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Category_id_seq"

ALTER TABLE "public"."Event" DROP CONSTRAINT "Event_pkey",
ALTER COLUMN "instructorId" SET DATA TYPE text ,
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Event_id_seq"

ALTER TABLE "public"."FollowersOfEvents" DROP CONSTRAINT "FollowersOfEvents_pkey",
ALTER COLUMN "followerId" SET DATA TYPE text ,
ALTER COLUMN "eventId" SET DATA TYPE text ,
ADD PRIMARY KEY ("followerId", "eventId")

ALTER TABLE "public"."Location" DROP CONSTRAINT "Location_pkey",
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" SET DATA TYPE text ,
ALTER COLUMN "eventId" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "Location_id_seq"

ALTER TABLE "public"."User" DROP CONSTRAINT "User_pkey",
ALTER COLUMN "id" DROP DEFAULT,
ALTER COLUMN "id" SET DATA TYPE text ,
ADD PRIMARY KEY ("id");
DROP SEQUENCE "User_id_seq"

ALTER TABLE "public"."_CategoryToEvent" ALTER COLUMN "A" SET DATA TYPE text ,
ALTER COLUMN "B" SET DATA TYPE text 

ALTER TABLE "public"."Event" ADD FOREIGN KEY("instructorId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."FollowersOfEvents" ADD FOREIGN KEY("followerId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."FollowersOfEvents" ADD FOREIGN KEY("eventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Location" ADD FOREIGN KEY("eventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CategoryToEvent" ADD FOREIGN KEY("A")REFERENCES "public"."Category"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CategoryToEvent" ADD FOREIGN KEY("B")REFERENCES "public"."Event"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201117211303..20201117214324
--- datamodel.dml
+++ datamodel.dml
@@ -3,13 +3,13 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model User {
-  id               Int                 @id @default(autoincrement())
+  id               String              @id @default(cuid())
   createdAt        DateTime            @default(now())
   updatedAt        DateTime            @updatedAt
   email            String              @unique
   hashedPassword   String
@@ -20,44 +20,44 @@
   Events           FollowersOfEvents[]
 }
 model Category {
-  id    Int     @id @default(autoincrement())
+  id    String  @id @default(cuid())
   name  String
   posts Event[]
 }
 /// These will be the online/offline events
 model Event {
-  id                Int                 @id @default(autoincrement())
+  id                String              @id @default(cuid())
   createdAt         DateTime            @default(now())
   updatedAt         DateTime            @updatedAt
   title             String
   datetime          DateTime
   //duration integer represents minutes
   duration          Int
   description       String?
   Instructor        User                @relation("instructorTable", fields: [instructorId], references: [id])
-  instructorId      Int
+  instructorId      String
   online            Boolean?            @default(true)
   Categories        Category[]
   FollowersOfEvents FollowersOfEvents[]
   Location          Location?
 }
 model FollowersOfEvents {
   Follower   User     @relation(fields: [followerId], references: [id])
-  followerId Int
+  followerId String
   Event      Event    @relation(fields: [eventId], references: [id])
-  eventId    Int
+  eventId    String
   createdAt  DateTime @default(now())
   @@id([followerId, eventId])
 }
 model Location {
-  id      Int   @id @default(autoincrement())
-  Event   Event @relation(fields: [eventId], references: [id])
-  eventId Int
+  id      String @id @default(cuid())
+  Event   Event  @relation(fields: [eventId], references: [id])
+  eventId String
   lat     Float
   lng     Float
 }
```


